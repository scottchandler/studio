// Generated by CoffeeScript 1.6.1
var standardWait;$.waypoints.settings.scrollThrottle=10;$.waypoints.settings.resizeThrottle=20;standardWait=50;describe("jQuery Waypoints",function(){var e,t,n;n=t=e=null;beforeEach(function(){loadFixtures("standard.html");t=$(window);return n=!1});describe("#waypoint()",function(){return it("errors out",function(){var e;e=function(){return $("#same1").waypoint()};return expect(e).toThrow($.Error)})});describe("#waypoint(callback)",function(){var r;r=null;beforeEach(function(){r=null;return e=$("#same1").waypoint(function(e){r=e;return n=!0})});it("creates a waypoint",function(){return expect($.waypoints().vertical.length).toEqual(1)});it("triggers the callback",function(){runs(function(){return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("uses the default offset",function(){runs(function(){return t.scrollTop(e.offset().top-1)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});return it("passes correct directions",function(){runs(function(){return t.scrollTop(e.offset().top)});waits(standardWait);runs(function(){expect(r).toEqual("down");return t.scrollTop(e.offset().top-1)});waits(standardWait);return runs(function(){return expect(r).toEqual("up")})})});describe("#waypoint(options)",function(){beforeEach(function(){return e=$("#same1")});it("creates a waypoint",function(){e.waypoint({offset:1,triggerOnce:!0});return expect($.waypoints().vertical.length).toEqual(1)});it("respects a px offset",function(){runs(function(){e.waypoint({offset:50,handler:function(){return n=!0}});return t.scrollTop(e.offset().top-51)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(e.offset().top-50)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("respects a % offset",function(){var r;r=null;runs(function(){e.waypoint({offset:"37%",handler:function(){return n=!0}});r=e.offset().top-$.waypoints("viewportHeight")*.37-1;return t.scrollTop(r)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(r+1)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("respects a function offset",function(){runs(function(){e.waypoint({offset:function(){return $(this).height()*-1},handler:function(){return n=!0}});return t.scrollTop(e.offset().top+e.height()-1)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(e.offset().top+e.height())});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("respects the bottom-in-view function alias",function(){var r;r=e.offset().top-$.waypoints("viewportHeight")+e.outerHeight();runs(function(){e.waypoint({offset:"bottom-in-view",handler:function(){return n=!0}});return t.scrollTop(r-1)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(r)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("destroys the waypoint if triggerOnce is true",function(){runs(function(){e.waypoint({triggerOnce:!0});return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect($.waypoints().length).toBeFalsy()})});it("triggers if continuous is true and waypoint is not last",function(){var n,r,i;n=$("#near1");r=$("#near2");i=0;runs(function(){e.add(n).add(r).waypoint(function(){return i++});return t.scrollTop(r.offset().top)});waits(standardWait);return runs(function(){return expect(i).toEqual(3)})});it("does not trigger if continuous false, waypoint not last",function(){var n,r,i;n=$("#near1");r=$("#near2");i=0;runs(function(){var s,o;s=function(){return i++};o={continuous:!1};e.add(r).waypoint(s);n.waypoint(s,o);return t.scrollTop(r.offset().top)});waits(standardWait);return runs(function(){return expect(i).toEqual(2)})});it("triggers if continuous is false, waypoint is last",function(){var n,r,i;n=$("#near1");r=$("#near2");i=0;runs(function(){var s,o;s=function(){return i++};o={continuous:!1};e.add(n).waypoint(s);r.waypoint(s,o);return t.scrollTop(r.offset().top)});waits(standardWait);return runs(function(){return expect(i).toEqual(3)})});return it("uses the handler option if provided",function(){var n;n=0;runs(function(){e.waypoint({handler:function(e){return n++}});return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(n).toEqual(1)})})});describe("#waypoint(callback, options)",function(){beforeEach(function(){var t,r;t=function(){return n=!0};r={offset:-1};return e=$("#same1").waypoint(t,r)});it("creates a waypoint",function(){return expect($.waypoints().vertical.length).toEqual(1)});it("respects options",function(){runs(function(){return t.scrollTop(e.offset().top)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(e.offset().top+1)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});return it("fires the callback",function(){runs(function(){return t.scrollTop(e.offset().top+1)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})})});describe('#waypoint("disable")',function(){beforeEach(function(){e=$("#same1").waypoint(function(){return n=!0});return e.waypoint("disable")});return it("disables callback triggers",function(){runs(function(){return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(n).toBeFalsy()})})});describe('.waypoint("enable")',function(){beforeEach(function(){e=$("#same1").waypoint(function(){return n=!0});e.waypoint("disable");return e.waypoint("enable")});return it("enables callback triggers",function(){runs(function(){return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})})});describe('#waypoint("destroy")',function(){beforeEach(function(){e=$("#same1").waypoint(function(){return n=!0});return e.waypoint("destroy")});it("removes waypoint from list of waypoints",function(){return expect($.waypoints().length).toBeFalsy()});it("no longer triggers callback",function(){runs(function(){return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(n).toBeFalsy()})});return it("does not preserve callbacks if .waypoint recalled",function(){runs(function(){e.waypoint({});return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(n).toBeFalsy()})})});describe('#waypoint("prev")',function(){it("returns jQuery object containing previous waypoint",function(){var t;e=$("#same1");t=$("#near1");e.add(t).waypoint({});return expect(t.waypoint("prev")[0]).toEqual(e[0])});return it("can be used in a non-window context",function(){var t;e=$("#inner1");t=$("#inner2");e.add(t).waypoint({context:"#bottom"});return expect(t.waypoint("prev","vertical","#bottom")[0]).toEqual(e[0])})});describe('#waypoint("next")',function(){return it("returns jQuery object containing next waypoint",function(){var t;e=$("#same1");t=$("#near1");e.add(t).waypoint({});return expect(e.waypoint("next")[0]).toEqual(t[0])})});describe("jQuery#waypoints()",function(){it("starts as an empty array for each axis",function(){expect($.waypoints().vertical.length).toBeFalsy();expect($.waypoints().horizontal.length).toBeFalsy();expect($.isPlainObject($.waypoints())).toBeTruthy();expect($.isArray($.waypoints().horizontal)).toBeTruthy();return expect($.isArray($.waypoints().vertical)).toBeTruthy()});it("returns waypoint elements",function(){e=$("#same1").waypoint({});return expect($.waypoints().vertical[0]).toEqual(e[0])});it("does not blow up with multiple waypoint",function(){e=$(".sameposition, #top").waypoint({});e=e.add($("#near1").waypoint({}));expect($.waypoints().vertical.length).toEqual(4);return expect($.waypoints().vertical[0]).toEqual($("#top")[0])});it("returns horizontal elements",function(){e=$("#same1").waypoint({horizontal:!0});return expect($.waypoints().horizontal[0]).toEqual(e[0])});return describe("Directional filters",function(){var n;n=null;beforeEach(function(){e=$("#same1");return n=$("#near1")});describe("above",function(){return it("returns waypoints only above the current scroll position",function(){runs(function(){e.add(n).waypoint({});return t.scrollTop(1500)});waits(standardWait);return runs(function(){return expect($.waypoints("above")).toEqual([e[0]])})})});describe("below",function(){return it("returns waypoints only below the current scroll position",function(){runs(function(){e.add(n).waypoint({});return t.scrollTop(1500)});waits(standardWait);return runs(function(){return expect($.waypoints("below")).toEqual([n[0]])})})});describe("left",function(){return it("returns waypoints only left of the current scroll position",function(){runs(function(){e.add(n).waypoint({horizontal:!0});return t.scrollLeft(1500)});waits(standardWait);return runs(function(){return expect($.waypoints("left")).toEqual([e[0]])})})});return describe("right",function(){return it("returns waypoints only right of the current scroll position",function(){runs(function(){e.add(n).waypoint({horizontal:!0});return t.scrollLeft(1500)});waits(standardWait);return runs(function(){return expect($.waypoints("right")).toEqual([n[0]])})})})})});describe('jQuery#waypoints("refresh")',function(){var r;r=null;beforeEach(function(){r=null;return e=$("#same1").waypoint(function(e){return r=e})});it("triggers callback if refresh crosses scroll",function(){runs(function(){return t.scrollTop(e.offset().top-1)});waits(standardWait);return runs(function(){e.css("top",e.offset().top-50+"px");$.waypoints("refresh");expect(r).toEqual("down");expect(r).not.toEqual("up");e.css("top",e.offset().top+50+"px");$.waypoints("refresh");expect(r).not.toEqual("down");return expect(r).toEqual("up")})});it("does not trigger callback if onlyOnScroll true",function(){var e;e=null;runs(function(){e=$("#same2").waypoint({onlyOnScroll:!0,handler:function(){return n=!0}});return t.scrollTop(e.offset().top-1)});waits(standardWait);return runs(function(){e.css("top",e.offset().top-50+"px");$.waypoints("refresh");expect(n).toBeFalsy();e.css("top",e.offset().top+50+"px");$.waypoints("refresh");return expect(n).toBeFalsy()})});return it("updates the offset",function(){runs(function(){t.scrollTop(e.offset().top-51);e.css("top",e.offset().top-50+"px");return $.waypoints("refresh")});waits(standardWait);runs(function(){expect(r).toBeFalsy();return t.scrollTop(e.offset().top)});waits(standardWait);return runs(function(){return expect(r).toBeTruthy()})})});describe('jQuery#waypoints("viewportHeight")',function(){return it("returns window innerheight if it exists",function(){return window.innerHeight?expect($.waypoints("viewportHeight")).toEqual(window.innerHeight):expect($.waypoints("viewportHeight")).toEqual($(window).height())})});describe('jQuery#waypoints("disable")',function(){return it("disables all waypoints",function(){var n;n=0;runs(function(){e=$(".sameposition").waypoint(function(){return n++});$.waypoints("disable");return t.scrollTop(e.offset().top+50)});waits(standardWait);return runs(function(){return expect(n).toEqual(0)})})});describe('jQuery#waypoints("enable")',function(){return it("enables all waypoints",function(){var n;n=0;runs(function(){e=$(".sameposition").waypoint(function(){return n++});$.waypoints("disable");$.waypoints("enable");return t.scrollTop(e.offset().top+50)});waits(standardWait);return runs(function(){return expect(n).toEqual(2)})})});describe('jQuery#waypoints("destroy")',function(){return it("destroys all waypoints",function(){e=$(".sameposition").waypoint({});$.waypoints("destroy");return expect($.waypoints().vertical.length).toEqual(0)})});describe('jQuery#waypoints("extendFn", methodName, function)',function(){return it("adds method to the waypoint namespace",function(){var e;e=null;$.waypoints("extendFn","myMethod",function(t){return e=t});$("#same1").waypoint("myMethod","test");return expect(e).toEqual("test")})});describe("jQuery#waypoints.settings",function(){var e,n;e=n=null;beforeEach(function(){e=0;return $(".sameposition, #near1, #near2").waypoint(function(){e++;return n=$(this).attr("id")})});it("throttles the scroll check",function(){runs(function(){t.scrollTop($("#same1").offset().top);return expect(e).toEqual(0)});waits(standardWait);return runs(function(){return expect(e).toEqual(2)})});return it("throttles the resize event and calls refresh",function(){runs(function(){$("#same1").css("top","-1000px");$(window).resize();return expect(e).toEqual(0)});waits(standardWait);return runs(function(){return expect(e).toEqual(1)})})});describe("non-window scroll context",function(){var t;t=null;beforeEach(function(){return t=$("#bottom")});it("triggers the waypoint within its context",function(){e=$("#inner3").waypoint({context:"#bottom",handler:function(){return n=!0}});runs(function(){return t.scrollTop(199)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(200)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("respects % offsets within contexts",function(){e=$("#inner3").waypoint({context:"#bottom",offset:"100%",handler:function(){return n=!0}});runs(function(){return t.scrollTop(149)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(150)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("respects function offsets within context",function(){e=$("#inner3").waypoint({context:"#bottom",offset:function(){return $(this).height()/2},handler:function(){return n=!0}});runs(function(){return t.scrollTop(149)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(150)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});it("respects bottom-in-view alias",function(){e=$("#inner3").waypoint({context:"#bottom",offset:"bottom-in-view",handler:function(){return n=!0}});runs(function(){return t.scrollTop(249)});waits(standardWait);runs(function(){expect(n).toBeFalsy();return t.scrollTop(250)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})});return afterEach(function(){return t.scrollTop(0)})});describe("Waypoints added after load, Issue #28, 62, 63",function(){return it("triggers down on new but already reached waypoints",function(){runs(function(){e=$("#same2");return t.scrollTop(e.offset().top+1)});waits(standardWait);runs(function(){return e.waypoint(function(e){return n=e==="down"})});return waitsFor(function(){return n},"#same2 to trigger",1e3)})});describe("Multiple waypoints on the same element",function(){var r;r=!1;beforeEach(function(){r=!1;e=$("#same1").waypoint({handler:function(){return n=!0}});return e.waypoint({handler:function(){return r=!0},offset:-50})});it("triggers all handlers",function(){runs(function(){return t.scrollTop(e.offset().top+50)});waits(standardWait);return runs(function(){return expect(n&&r).toBeTruthy()})});it("uses only one element in $.waypoints() array",function(){return expect($.waypoints().vertical.length).toEqual(1)});return it("disables all waypoints on the element when #disabled called",function(){runs(function(){e.waypoint("disable");return t.scrollTop(e.offset().top+50)});waits(standardWait);return runs(function(){return expect(n||r).toBeFalsy()})})});describe("Horizontal waypoints",function(){var n;n=null;beforeEach(function(){n=null;return e=$("#same1").waypoint({horizontal:!0,handler:function(e){return n=e}})});return it("triggers right/left direction",function(){runs(function(){return t.scrollLeft(e.offset().left)});waits(standardWait);runs(function(){expect(n).toEqual("right");return t.scrollLeft(e.offset().left-1)});waits(standardWait);return runs(function(){return expect(n).toEqual("left")})})});describe("Waypoints attached to window object, pull request 86",function(){var t;t=$(window);beforeEach(function(){return e=t.waypoint({offset:-t.height(),handler:function(){return n=!0}})});return it("triggers waypoint reached",function(){runs(function(){return t.scrollTop(t.height()+1)});waits(standardWait);return runs(function(){return expect(n).toBeTruthy()})})});return afterEach(function(){$.waypoints("destroy");t.scrollTop(0).scrollLeft(0);n=!1;return waits(standardWait)})});